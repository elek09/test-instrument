<!DOCTYPE html>
<html>

<head>
    <!-- @css -->
    <meta charset="UTF-8">
    <link rel="stylesheet" href="pf-module-glasscockpit-testing/glasscockpit-testing.css">
    <link rel="stylesheet" href="pf-test-instrument.css">
    <!-- @css -->
</head>

<body>
    <!-- @body id="PF-TEST-INSTRUMENT" -->
    <div id="Mainframe">
        <div id="Electricity" state="off">
            <div id="panel-container" class="container" state="off">
                <!-- Content pages -->
                <div id="attitudePage" class="content" id="instrumentPanel" style="background-color: lightblue;">
                    <h1 style="text-align: center; font-size: 36px;">Attitude Page</h1>
                    <svg id="attitudeIndicator" width="650" height="650" viewBox="-150 -150 300 300">
                        <!-- Background colors: Sky and ground -->
                        <rect x="-150" y="-150" width="300" height="150" fill="skyblue" />
                        <rect x="-150" y="0" width="300" height="150" fill="#895129" />

                        <!-- Bank angle path -->
                        <path id="bankArc" d="M -140 0 A 140 140 0 0 1 140 0" fill="none" stroke="white"
                            stroke-width="2" />

                        <!-- Bank angle tick marks -->
                        <line x1="0" y1="-140" x2="0" y2="-150" stroke="white" stroke-width="2"
                            transform="rotate(-30)" />
                        <line x1="0" y1="-140" x2="0" y2="-150" stroke="white" stroke-width="2"
                            transform="rotate(-60)" />
                        <line x1="0" y1="-140" x2="0" y2="-150" stroke="white" stroke-width="2"
                            transform="rotate(30)" />
                        <line x1="0" y1="-140" x2="0" y2="-150" stroke="white" stroke-width="2"
                            transform="rotate(60)" />

                        <!-- (long line - dot - long line) -->
                        <line x1="-30" y1="0" x2="-10" y2="0" stroke="yellow" stroke-width="5" />
                        <circle cx="0" cy="0" r="5" fill="yellow" />
                        <line x1="10" y1="0" x2="30" y2="0" stroke="yellow" stroke-width="5" />

                        <!-- Bank angle triangle -->
                        <polygon id="fixedWhiteBankArc" points="0,-140 10,-150 -10,-150" fill="white" />

                        <!-- Pitch Group (pitch-related elements) -->
                        <g id="pitchGroup">
                            <!-- Horizon line -->
                            <line id="horizonLine" x1="-150" y1="0" x2="150" y2="0" stroke="white" stroke-width="2" />

                            <!-- Above horizon (long lines) -->
                            <line x1="-50" y1="-30" x2="50" y2="-30" stroke="white" stroke-width="2" />
                            <line x1="-50" y1="-60" x2="50" y2="-60" stroke="white" stroke-width="2" />
                            <line x1="-50" y1="-90" x2="50" y2="-90" stroke="white" stroke-width="2" />

                            <!-- Numbers for pitch above horizon -->
                            <text x="-70" y="-25" fill="white" font-size="12">10</text>
                            <text x="-70" y="-55" fill="white" font-size="12">20</text>
                            <text x="-70" y="-85" fill="white" font-size="12">30</text>

                            <text x="60" y="-25" fill="white" font-size="12">10</text>
                            <text x="60" y="-55" fill="white" font-size="12">20</text>
                            <text x="60" y="-85" fill="white" font-size="12">30</text>

                            <!-- Below horizon (long lines) -->
                            <line x1="-50" y1="30" x2="50" y2="30" stroke="white" stroke-width="2" />
                            <line x1="-50" y1="60" x2="50" y2="60" stroke="white" stroke-width="2" />
                            <line x1="-50" y1="90" x2="50" y2="90" stroke="white" stroke-width="2" />

                            <!-- Numbers for pitch below horizon -->
                            <text x="-70" y="35" fill="white" font-size="12">10</text>
                            <text x="-70" y="65" fill="white" font-size="12">20</text>
                            <text x="-70" y="95" fill="white" font-size="12">30</text>

                            <text x="60" y="35" fill="white" font-size="12">10</text>
                            <text x="60" y="65" fill="white" font-size="12">20</text>
                            <text x="60" y="95" fill="white" font-size="12">30</text>

                            <!-- Small lines above and below -->
                            <line x1="-35" y1="-15" x2="35" y2="-15" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="-45" x2="35" y2="-45" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="-75" x2="35" y2="-75" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="-105" x2="35" y2="-105" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="15" x2="35" y2="15" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="45" x2="35" y2="45" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="75" x2="35" y2="75" stroke="white" stroke-width="1" />
                            <line x1="-35" y1="105" x2="35" y2="105" stroke="white" stroke-width="1" />
                        </g>

                        <!-- Bank Group (elements that rotate) -->
                        <g id="bankGroup">
                            <polygon id="bankArcTriangle" points="0,-138 10,-128 -10,-128" fill="yellow" />
                        </g>
                    </svg>



                    <!-- Sliders for pitch, bank, and slip -->
                    <!--
                    <div style="text-align: center; margin-top: 20px;">
                        <label for="upDownSlider">Up-Down</label>
                        <input type="range" id="upDownSlider" min="-100" max="100" value="0">

                        <label for="turningSlider">Turning</label>
                        <input type="range" id="turningSlider" min="-60" max="60" value="0">
                    </div>
                    -->
                </div>

                <!-- Status Page -->
                <div id="statusPage" class="content" style="background-color: #333; display:none;">
                    <h1 style="text-align: center; font-size: 36px; color: white;">Status Page</h1>

                    <div id="statusIndicators"
                        style="display: flex; justify-content: space-around; align-items: center;">

                        <!-- Flaps Indicator Section -->
                        <div id="flapsIndicator" style="text-align: center;">
                            <p>FLAPS</p>
                            <div class="flapGroup" style="display: flex; justify-content: space-between; width: 200px;">
                                <div class="flapBar">
                                    <div class="flapValue" id="leftFlap"></div>
                                    <div class="flapTarget" id="leftFlapTarget"></div>
                                </div>
                                <div class="flapBar">
                                    <div class="flapValue" id="rightFlap"></div>
                                    <div class="flapTarget" id="rightFlapTarget"></div>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; width: 200px;">
                                <p>LEFT</p>
                                <p>RIGHT</p>
                            </div>
                        </div>

                        <!-- EGT Indicator Section -->
                        <div id="egtIndicator" style="text-align: center;">
                            <p>EXHAUST GAS TEMPERATURE</p>
                            <div class="egtGroup" style="display: flex; justify-content: space-between; width: 200px;">
                                <div class="egtBar">
                                    <div class="egtValue" id="egt1"></div>
                                    <div class="egtThreshold" id="egtThreshold1"></div>
                                </div>
                                <div class="egtBar">
                                    <div class="egtValue" id="egt2"></div>
                                    <div class="egtThreshold" id="egtThreshold2"></div>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; width: 200px;">
                                <p>E1 EGT <br><span style="color: green;" id="egt1Value">300°C</span></p>
                                <p>E2 EGT <br><span style="color: orange;" id="egt2Value">700°C</span></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Buttons for pagination -->
                <div style="text-align: center; margin-top: 20px;">
                    <button id="btnAttitude">Attitude</button>
                    <button id="btnStatus">Status</button>
                </div>
            </div>
        </div>
        <!-- @body -->

        <div id="glasscockpit-testing"></div>

        <!-- @js path="/Pages/VCockpit/Instruments/TEST_Instrument/PFD"-->
        <script src="pf-test-instrument-constants.js"></script>
        <!-- @js -->

        <script src="pf-module-glasscockpit-testing/glasscockpit-testing.js"></script>
        <script src="pf-module-glasscockpit-testing/rulers.js"></script>

        <script>
            // TODO Add your variables here (and change the one below when dont needed)
            glasscockpitTesting.addSimVar("A:CIRCUIT", "Bool", 0, "circuit_on", 0, 1, 1, 1);
            glasscockpitTesting.addSimVar("A:PITCH", "Degree", 0, "pitch_control", -100, 100, 1, 0);
            glasscockpitTesting.addSimVar("A:BANK", "Degree", 0, "bank_control", -60, 60, 1, 0);


            // Add your JavaScript code here
            // Threshold values for EGT
            const EGT_GREEN_LIMIT = 680;
            const EGT_AMBER_LIMIT = 750;
            const EGT_MIN_TEMP = 100;
            const EGT_MAX_TEMP = 899;

            // Update Flaps Indicator
            function updateFlaps(leftFlapPosition, rightFlapPosition, leftFlapTarget, rightFlapTarget) {
                const leftFlap = document.getElementById('leftFlap');
                const rightFlap = document.getElementById('rightFlap');
                const leftTarget = document.getElementById('leftFlapTarget');
                const rightTarget = document.getElementById('rightFlapTarget');

                // Adjust flap heights based on position
                leftFlap.style.height = `${leftFlapPosition}%`;
                rightFlap.style.height = `${rightFlapPosition}%`;

                // Adjust target positions
                leftTarget.style.bottom = `${leftFlapTarget}%`;
                rightTarget.style.bottom = `${rightFlapTarget}%`;

                // Hide target line if the flap reaches its target
                leftTarget.style.display = leftFlapPosition === leftFlapTarget ? 'none' : 'block';
                rightTarget.style.display = rightFlapPosition === rightFlapTarget ? 'none' : 'block';

            }
            // Update Flaps Indicator
            function updateFlaps(
                leftFlapPosition,
                rightFlapPosition,
                leftFlapTarget,
                rightFlapTarget
            ) {
                const leftFlap = document.getElementById("leftFlap");
                const rightFlap = document.getElementById("rightFlap");
                const leftTarget = document.getElementById("leftFlapTarget");
                const rightTarget = document.getElementById("rightFlapTarget");

                // Adjust flap heights based on position
                leftFlap.style.height = `${leftFlapPosition}%`;
                rightFlap.style.height = `${rightFlapPosition}%`;

                // Adjust target positions
                leftTarget.style.bottom = `${leftFlapTarget}%`;
                rightTarget.style.bottom = `${rightFlapTarget}%`;

                // Hide target line if the flap reaches its target
                leftTarget.style.display =
                    leftFlapPosition === leftFlapTarget ? "none" : "block";
                rightTarget.style.display =
                    rightFlapPosition === rightFlapTarget ? "none" : "block";
            }

            // Update EGT Indicator
            function updateEGT(egt1Value, egt2Value) {
                const egt1 = document.getElementById('egt1');
                const egt2 = document.getElementById('egt2');
                const egt1Text = document.getElementById('egt1Value');
                const egt2Text = document.getElementById('egt2Value');

                // Calculate EGT bar heights as a percentage of the total range
                const egt1Height = ((egt1Value - EGT_MIN_TEMP) / (EGT_MAX_TEMP - EGT_MIN_TEMP)) * 100;
                const egt2Height = ((egt2Value - EGT_MIN_TEMP) / (EGT_MAX_TEMP - EGT_MIN_TEMP)) * 100;

                // Update the bar heights
                egt1.style.height = `${egt1Height}%`;
                egt2.style.height = `${egt2Height}%`;

                // Update text values
                egt1Text.innerText = `${egt1Value}°C`;
                egt2Text.innerText = `${egt2Value}°C`;

                // Change colors based on temperature
                const updateColor = (element, value) => {
                    if (value > EGT_AMBER_LIMIT) {
                        element.style.backgroundColor = 'red';
                        element.nextElementSibling.style.color = 'red'; // Update text color
                    } else if (value > EGT_GREEN_LIMIT) {
                        element.style.backgroundColor = 'orange';
                        element.nextElementSibling.style.color = 'orange';
                    } else {
                        element.style.backgroundColor = 'green';
                        element.nextElementSibling.style.color = 'green';
                    }
                };

                // Apply color changes to EGT1 and EGT2
                updateColor(egt1, egt1Value);
                updateColor(egt2, egt2Value);
            }

            updateFlaps(50, 70, 30, 60); // Flaps: 50% left, 70% right
            updateEGT(300, 750); 
        </script>

        <!-- @js path="/Pages/VCockpit/Instruments/TEST_Instrument/PFD"-->
        <script src="pf-module-glasscockpit-testing/glasscockpit-testing.js"></script>
        <script src="pf-test-instrument.js"></script>
        <!-- @js -->
</body>

</html>